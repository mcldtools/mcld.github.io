<html lang=en>
<head>
	<title>CLD Assessment A1</title>
	<link rel="icon" type="image/png" href="/logo150.png"/>
	<link rel="apple-touch-icon" href="/logo512.png">
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="/style.css">
	<script type='text/javascript' src=/all.js></script>
</head>
<body>
	<nav><a href=/ >Home</a> <a href=/data.html>Data</a></nav>
	<h2>Results by Dimension</h2>
	<script>
		function putXY(r,i,n){ // convert radius and index in spider to x,y pair
			a=(2*Math.PI*i)/n;
			x=Math.floor(120+r*Math.sin(a));
			y=Math.floor(120-r*Math.cos(a));
			document.write(' '+Math.floor(x)+','+Math.floor(y));
		}
		const labels=['A','B','C','D','E','F','G','H','I']; // uppercase version of labels
		const lengths=[7,2,5,2,2,2,1,3,3]; // number of sub-elements in each
		function computeScores(labels,lengths) {
			let scores=[0,0,0,0,0,0,0,0,0];
//			console.log('cookies',document.cookie);
			for(i=0;i<labels.length;i++) { // which major dimension
				for(j=1;j<=lengths[i];j++) { // which sub dimension
					const cname=labels[i].toLowerCase()+j;
					let x = +getCookie(cname);
					x--;
					if(x<1) x=0;
					console.log('score',i,j,cname,x);
					scores[i] += x;
				}
				scores[i]=Math.floor(scores[i]*100/(lengths[i]*3));
//				console.log('Scores',i,scores[i]);
			}
			return scores;
		}
		/*	Draw a spider diagram based on the results
			For now, we use fake data */
		const data=computeScores(labels,lengths);
		n=data.length;
		document.write('<svg viewBox="0 0 240 240" xmlns="http://www.w3.org/2000/svg">');
		document.write('<style> .n {font: 10px sans-serif; fill: black;}</style>'); 
			for(r=10;r<110;r=r+10) { // first layout the grid
				y=120-r;
				document.write('<text class="n" x="121" y="'+y+'">'+r+'</text>');
				document.write('<polygon points="');
				for(i=0;i<n;i++) { putXY(r,i,n);}
				document.write('" fill="none" stroke="blue" /></polygon>');
			}
		// Next draw the data points
		document.write('<polygon points="');
		for(i=0;i<n;i++) { putXY(data[i],i,n);}
		document.write('" fill="green" fill-opacity="25%" stroke="darkgreen"></polygon>');
		// Next put the labels in the appropriate points
		for(i=0;i<n;i++){
			a=(2*Math.PI*i)/n;
			x=Math.floor(115+105*Math.sin(a));
			y=Math.floor(125-105*Math.cos(a));
			document.write('<text class="n" x="'+x+'" y="'+y+'">'+labels[i]+'</text>');
		}
		document.write("</svg>\n");
	</script>
	<center>
	<table style="font-size:12px;">
		<tr><th>Score</th><th>Dimension</th></tr>
	<tr><td id=c0></td><td>A: Participation, Inclusion and Voice</td></tr>
	<tr><td id=c1></td><td>B: Local Resources and Assets</td></tr>
	<tr><td id=c2></td><td>C: Exit Strategy Linked to Sustainability</td></tr>
	<tr><td id=c3></td><td>D: Accountability Mechanisms</td></tr>
	<tr><td id=c4></td><td>E: Responsiveness to Context Specific Dynamics</td></tr>
	<tr><td id=c5></td><td>F: Collaboration within and amongst communities</td></tr>
	<tr><td id=c6></td><td>G: CLD linked to Sub-National Governments</td></tr>
	<tr><td id=c7></td><td>H: Monitoring and Evaluation Practices support CLD</td></tr>
	<tr><td id=c8></td><td>I: Facilitation Investment and Intensity</td></tr>
</table>
</center>
<script>
	for(i=0;i<9;i++) document.getElementById('c'+i).innerHTML=data[i];
</script>
</body>
</html>
